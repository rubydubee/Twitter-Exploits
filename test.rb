#!/usr/bin/env ruby
#Begun by blood,by blood undone! - from my new ruby twitter library(in making)

$: << File.dirname(__FILE__)
require 'rubygems'
require 'oauth'
require "ObjectStash.rb"
require 'pp'
require "bot.rb"
 
if(!File.exist?("access_token.stash"))
	consumer = OAuth::Consumer.new "JHaEyronIWhl1KtUWWcPw",
		                  "jo7o9GgoPqsx37g0JrrZogpO16YC4rnZ79rx7Ugjoco",
		                   { :site => 'http://api.twitter.com',
		                     :request_token_path => '/oauth/request_token',
		                     :access_token_path => '/oauth/access_token',
		                     :authorize_path => '/oauth/authorize'}
	 
	request_token = consumer.get_request_token
	puts "Place \"#{request_token.authorize_url}\" in your browser"
	print "Enter the number they give you: "
	pin = STDIN.readline.chomp
	 
	access_token = request_token.get_access_token(:oauth_verifier => pin)
	ObjectStash.store access_token, "access_token.stash"
else 
	access_token = ObjectStash.load "access_token.stash"
end
#status = CGI::escape("I love http://rajnifacts.tumblr.com");
#pp access_token.get("/statuses/friends_timeline.json?count=1").body

bot = Bot.new(access_token)
bot.unfollow_traitors
